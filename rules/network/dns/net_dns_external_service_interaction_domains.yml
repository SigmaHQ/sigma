title: DNS Query to External Service Interaction Domains
id: aff715fa-4dd5-497a-8db3-910bea555566
status: test
description: Detects suspicious DNS queries to external service interaction domains often used for out-of-band interactions after successful RCE
references:
    - https://twitter.com/breakersall/status/1533493587828260866
author: Florian Roth (Nextron Systems), Matt Kelly (list of domains)
date: 2022-06-07
modified: 2025-10-26
tags:
    - attack.initial-access
    - attack.t1190
    - attack.reconnaissance
    - attack.t1595.002
logsource:
    category: dns
detection:
    selection:
        query|contains:
            - '.interact.sh'
            - '.oast.pro'
            - '.oast.live'
            - '.oast.site'
            - '.oast.online'
            - '.oast.fun'
            - '.oast.me'
            - '.burpcollaborator.net'
            - '.oastify.com'
            - '.canarytokens.com'
            - '.requestbin.net'
            - '.dnslog.cn'
            - '.ceye.io'
            - '.ddns.1443.eu.org' # dig.pm
            - '.ddns.xn--gg8h.eu.org' # dig.pm
            - '.ddns.bypass.eu.org' # dig.pm
            - '.dnshook.site' # webhook.site
            - '.dnslog.ink' # dnslog.ink
            - '.log.dnslog.pp.ua' # dnslog.org
            - '.log.nat.cloudns.ph' # dnslog.org
            - '.log.dnslogs.dpdns.org' # dnslog.org
            - '.log.dnslog.qzz.io' # dnslog.org
            - '.p8.lol' # javaweb.org
            - '.log.javaweb.org' # javaweb.org
            - '.dns.su18.org' # javaweb.org
    filter_polling:
        query:
          - 'polling.oastify.com'
    condition: selection and not 1 of filter_*
falsepositives:
    - Legitimate security tooling
level: high
