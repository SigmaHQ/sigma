title: Cowrie - Shell Execution via Rsync
id: 7a5d9647-f1f1-4858-b5db-23905a1b70a2
related:
  - id: e2326866-609f-4015-aea9-7ec634e8aa04
    type: similar
status: experimental
description: |
  Detects the use of the "rsync" utility to execute a shell. Such behavior may be associated with privilege escalation, unauthorized command execution, or to break out from restricted environments.
references:
  - https://gtfobins.github.io/gtfobins/rsync/#shell
author: Saravanan Palanisamy
date: 2025-08-24
modified: 2025-08-24
tags:
  - attack.execution
  - attack.t1059
logsource:
  product: cowrie
  category: application
detection:
  selection1:
    input|contains:
      - "rsync"
      - "rsyncd"
  selection2:
    input|contains: " -e "
  selection3:
    input|contains:
      - "ash"
      - "bash"
      - "dash"
      - "csh"
      - "sh"
      - "zsh"
      - "tcsh"
      - "ksh"
  condition: all of selection*
falsepositives:
  - Unlikely
level: high