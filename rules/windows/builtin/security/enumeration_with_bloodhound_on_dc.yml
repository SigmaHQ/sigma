title: Possible Remote BloodHound Usage
id: 3e185583-0e99-4f65-a9dc-c37bcdd6d26d
status: experimental
description: Detects suspicious AD enumeration activity consistent with remote BloodHound usage - EventID 4799 on domain controller where CallerProcessId is 0x0. Correlate with other AD-enumeration events and high query volumes.
author:
  - Arthur Shaymardanov
  - Danil Zagidullin
tags:
  - attack.discovery
  - attack.adversary_emulation
  - bloodhound
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4799
    ComputerName: DC name
    CallerProcessId: "0x0"
  condition: selection
falsepositives:
  - Legitimate administrative enumeration run from system context or scheduled system tasks on the domain controller.
  - AD management/backup tools that invoke system-level LDAP/AD queries from the DC itself.
level: high
notes:
  - EventID 4799 can indicate enumeration of local group membership or domain enumeration activity depending on vendor mappings â€” verify exact event mapping in your environment.
  - CallerProcessId = 0x0 on the domain controller is unusual and merits investigation: check associated events (Logon, Process Create, LDAP queries) and correlate with source IPs and account names.
  - Recommended enrichments: correlate with high volume of LDAP/NetQuery/LDAP searches, multiple related enumeration EventIDs (e.g., 4662/4663/4732/4733/4798/4799), and unusual accounts or remote source hosts.
  - Suggested tuning: add a whitelist for known backup/management service accounts and scheduled tasks; require X events in Y minutes (e.g., >20 events in 5 minutes) to reduce false positives.
