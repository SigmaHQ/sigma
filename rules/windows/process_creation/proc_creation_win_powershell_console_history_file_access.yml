title: Possible PowerShell Console History File Access Attempt
id: f4ff7323-b5fc-4323-8b52-6b9408e15788
status: experimental
description: Detects possible access attempts to the PowerShell console history directly via history file (ConsoleHost_history.txt). This can give access to plaintext passwords used in PowerShell commands or used for general reconnaissance.
references:
    - https://0xdf.gitlab.io/2018/11/08/powershell-history-file.html
author: Luc GÃ©naux
date: 2025-04-03
tags:
    - attack.credential-access
    - attack.t1552.001
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        CommandLine|contains:
            - 'ConsoleHost_history.txt'
            - '(Get-PSReadlineOption).HistorySavePath'
    condition: selection
falsepositives:
    - Curious user opening it's own history file. If manual opening detection is not needed, text editors like Notepad can be filtered out.
level: medium
