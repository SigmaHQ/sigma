title: VMWare Workspace One Access Exploitation (CVE-2022-22954)
id: 5660d8db-6e25-411f-b92f-094420168a5d
description: >
  Detects possible exploitation vulnerability CVE-2022-22954. As reported by Morphisec, part of the attack chain, 
  threat actors used PowerShell commands that executed as a child processes of the legitimate Tomcat prunsrv.exe process application.
status: experimental
date: 2022/04/25
author: '@kostastsale'
references:
    - https://blog.morphisec.com/vmware-identity-manager-attack-backdoor
    - https://nvd.nist.gov/vuln/detail/CVE-2022-22954
logsource:
    category: process_creation
    product: windows
detection:
    selection1:
        ParentImage|endswith: 
          - '\prunsrv.exe'
        Image|endswith: 
          - '\powershell.exe'
    selection2:
        ParentImage|endswith: 
          - '\prunsrv.exe'
        Image|endswith: 
          - '\cmd.exe'
        CommandLine|contains:
          - 'cmd.exe /c powershell'
    condition: selection1 OR selection2
falsepositives:
    - Some false positives are possible as part of a custom script implementation from admins executed with cmd.exe as the child process.
level: high
tags:
    - attack.execution
    - attack.T1059.006
    - attack.initial_access
    - attack.t1190
