title: OpenEDR Spawning Command Shell
id: 7f3a9c2d-4e8b-4a7f-9d3e-5c6f8a9b2e1d
status: test
description: |
  Detects the OpenEDR ssh-shellhost.exe spawning a command shell (cmd.exe) or PowerShell with PTY (pseudo-terminal)
  capabilities. This may indicate remote command execution through OpenEDR's remote management features, which could be
  legitimate administrative activity or potential abuse of the remote access tool.
author: "@kostastsale"
date: 2025-10-21
references:
    - https://kostas-ts.medium.com/detecting-abuse-of-openedrs-permissive-edr-trial-a-security-researcher-s-perspective-fc55bf53972c
tags:
    - attack.execution
    - attack.t1059.003
    - attack.lateral-movement
    - attack.t1021.004
    - attack.command-and-control
    - attack.t1219
logsource:
    product: windows
    category: process_creation
detection:
    selection_image:
        Image|endswith: '\ssh-shellhost.exe'
    selection_cmdline_cmd:
        CommandLine|contains|all:
            - '--pty'
            - 'cmd'
    selection_cmdline_powershell:
        CommandLine|contains|all:
            - '--pty'
            - 'powershell'
    selection_parent:
        ParentImage|endswith: '\ITSMService.exe'
    condition: selection_image and (selection_cmdline_cmd or selection_cmdline_powershell) and selection_parent
falsepositives:
    - Legitimate OpenEDR remote administration sessions
    - Authorized IT support using OpenEDR remote shell features
    - Scheduled maintenance tasks via OpenEDR console
level: low
fields:
    - CommandLine
    - User
    - ParentCommandLine
    - ProcessId
    - ParentProcessId
