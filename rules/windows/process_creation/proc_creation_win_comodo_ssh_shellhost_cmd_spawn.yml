title: COMODO Endpoint Manager SSH Shell Host Spawning Command Shell
id: 7f3a9c2d-4e8b-4a7f-9d3e-5c6f8a9b2e1d
status: test
description: |
  Detects the COMODO Endpoint Manager ssh-shellhost.exe spawning a command shell (cmd.exe) or PowerShell with PTY (pseudo-terminal) 
  capabilities. This may indicate remote command execution through COMODO's remote management features, which could be 
  legitimate administrative activity or potential abuse of the remote access tool.
  The ssh-shellhost.exe process creates an interactive shell session that can be used for remote system administration.
author: Kostas Tsialemis
date: 2025-10-21
references:
  - https://kostas-ts.medium.com/detecting-abuse-of-openedrs-permissive-edr-trial-a-security-researcher-s-perspective-fc55bf53972c
tags:
  - attack.execution
  - attack.t1059.003
  - attack.lateral_movement
  - attack.t1021.004
  - attack.command_and_control
  - attack.t1219
logsource:
  product: windows
  category: process_creation
detection:
  selection_image:
    Image|endswith: '\ssh-shellhost.exe'
  selection_cmdline_cmd:
    CommandLine|contains|all:
      - '--pty'
      - 'cmd'
  selection_cmdline_powershell:
    CommandLine|contains|all:
      - '--pty'
      - 'powershell'
  selection_parent:
    ParentImage|endswith: '\ITSMService.exe'
  condition: selection_image and (selection_cmdline_cmd or selection_cmdline_powershell) and selection_parent
falsepositives:
  - Legitimate COMODO Endpoint Manager remote administration sessions
  - Authorized IT support using COMODO remote shell features
  - Scheduled maintenance tasks via COMODO console
level: medium
fields:
  - CommandLine
  - User
  - ParentCommandLine
  - ProcessId
  - ParentProcessId
