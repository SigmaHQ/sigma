title: Execution of vshadow with exec parameter
id: d7c75059-2901-4578-b209-8837fd31c6a8
status: experimental
description: Detects invocation of vshadow.exe with the -exec parameter by monitoring Windows process creation events (EventID 1) where the target image ends with '\vshadow.exe' and the command line contains '-exec'. While legitimate backup or administrative scripts may use this flag, Attackers can leverage this parameter to hide and execute malware within shadow copies, evading standard detection mechanisms.
author: David Faiss
date: 2025-05-26
references:
    - https://lolbas-project.github.io/lolbas/OtherMSBinaries/Vshadow/
tags:
    - attack.t1202
logsource:
    product: windows
    category: process_creation
detection:
    selection:
        Image|endswith: '\vshadow.exe'
        CommandLine|contains: '-exec'
    condition: selection
falsepositives:
    - System-Backup- or Admin-Tools
    - Legitimate administrative scripts
level: high
