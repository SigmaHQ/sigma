title: Remote Access Tool - Renamed MeshAgent Execution
id: b471f462-eb0d-4832-be35-28d94bdb4780
related:
    - id: bd3b5eaa-439d-4a42-8f35-a49f5c8a2582
      type: similar
    - id: 2fbbe9ff-0afc-470b-bdc0-592198339968
      type: derived
status: experimental
description: |
    Detects the execution of a renamed instance of the Remote Monitoring and Management (RMM) tool, MeshAgent.
    RMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate remote support and system management.
    However, malicious actors may exploit these tools by renaming them to bypass detection mechanisms, enabling unauthorized access and control over compromised systems.
references:
    - https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access
    - https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/
    - https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/
    - https://www.security.com/threat-intelligence/medusa-ransomware-attacks
author: Norbert Ja≈õniewicz (AlphaSOC)
date: 2025-05-19
tags:
    - attack.command-and-control
    - attack.defense-evasion
    - attack.t1219.002
    - attack.t1036.003
logsource:
    category: process_creation
    product: windows
detection:
    selection_cmd:
        CommandLine|contains: '--meshServiceName'
    selection_metadata:
        OriginalFileName|contains: 'meshagent'
    filter_cmd:
        CommandLine|contains: 'meshagent'
    filter_img:
        Image|endswith: '\meshagent.exe'
    condition: (selection_cmd and not filter_cmd) or (selection_metadata and not filter_img)
fields:
    - CommandLine
    - ParentImage
    - Image
    - OriginalFileName
falsepositives:
    - Unknown
level: high
