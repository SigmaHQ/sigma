title: File Created via OpenEDR Response Features
id: 9e4b7d3a-6f2c-4e9a-8d1b-3c5e7a9f2b4d
status: test
description: |
  Detects suspicious file creation by OpenEDR's ITSMService.exe in unusual locations.
  The ITSMService is responsible for remote management operations and can be used to upload/create files
  on the system through the Process Explorer or file management features. While legitimate for IT operations,
  this activity could indicate unauthorized file uploads, data staging, or malicious file deployment.
author: "@kostastsale"
date: 2025-10-21
references:
    - https://kostas-ts.medium.com/detecting-abuse-of-openedrs-permissive-edr-trial-a-security-researcher-s-perspective-fc55bf53972c
tags:
    - attack.command_and_control
    - attack.t1105
    - attack.lateral_movement
    - attack.t1570
    - attack.t1219
logsource:
    product: windows
    category: file_event
detection:
    selection_process:
        Image|endswith: '\COMODO\Endpoint Manager\ITSMService.exe'
    selection_suspicious_extensions:
        TargetFilename|endswith:
            - '.exe'
            - '.dll'
            - '.ps1'
            - '.bat'
            - '.cmd'
            - '.vbs'
            - '.js'
            - '.hta'
            - '.scr'
            - '.com'
            - '.pif'
            - '.zip'
            - '.rar'
            - '.7z'
    condition: selection_process and selection_suspicious_extensions
falsepositives:
    - Legitimate OpenEDR file management operations
    - Authorized remote file uploads by IT administrators
    - Software deployment through OpenEDR console
level: low
fields:
    - TargetFilename
    - Image
    - User
    - ProcessId
    - CreationUtcTime
