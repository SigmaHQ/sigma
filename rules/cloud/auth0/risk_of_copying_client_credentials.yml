title: High Risk Event - Risk of Copying Client Credentials
id: 51fccf5b-3343-4cd5-abea-56e8bd59b156
status: experimental
description: >
  Detect potential risks of copying client credentials by monitoring if a client is read via the Dashboard or Management API.
  This can indicate that someone is trying to copy client credentials for malicious purposes.
author: Okta, austinsonger
date: 2025-08--19
logsource:
  product: auth0
  service: oidc_oauth2
detection:
  selection:
    data.type: mgmt_api_read
    data.description: "Get client by ID"
    data.details.accessedSecrets{}: client_secret
    data.details.response.body.client_id:
      - "critical-client_id-1"
      - "critical-client_id-etc"
  condition: selection
explanation: >
  This detection monitors when client settings are accessed via the Auth0 Management API.
  Specifically, it filters on events where the `client_secret` is included in the response,
  and the targeted `client_id` is among a list of known critical applications.
  This may indicate credential harvesting or administrative misuse.
  Splunk query:
    index=auth0 data.tenant_name="{your-tenant-name}"
    data.type="mgmt_api_read" data.description="Get client by ID"
    data.details.accessedSecrets{}=client_secret
    data.details.response.body.client_id IN ("critical-client_id-1", "critical-client_id-etc")
    | table data.details.response.body.client_id, data.user_id, data.ip
  Tenant logs:
    type: "mgmt_api_read" AND description: "Get client by ID"
comments: >
  - Tune the list of monitored client_ids to cover only high-risk or externally-facing applications.
  - This query should be scoped to specific tenants via the `tenant_name` field.
  - This detection assumes you rely on shared client secrets (confidential clients); mobile/SPAs may be excluded.
  - Ensure that alerting thresholds are adjusted for authorized but rare access patterns.
  - Consider rotating client_secret values regularly and migrating to private_key_jwt when possible.
  - Limit number of tenant admins and users with the "Editor - Specific App" or "Viewer - Config Settings" roles.
  - Rotate credentials on a schedule or after exposure.
  - Enforce stronger auth schemes such as private_key_jwt instead of client_secret.
falsepositives:
  - Administrator manually reviewing application settings (investigate user_id).
level: medium
tags:
  - attack.credential-access
  - attack.t1528
references:
  - https://github.com/auth0/auth0-customer-detections
