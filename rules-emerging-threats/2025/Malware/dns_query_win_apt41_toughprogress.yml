title: DNS Query To APT41 TOUGHPROGRESS Infrastructure
id: f8c1e80b-c73a-476a-ae24-6c72528b1521
status: experimental
description: |
    Detects DNS queries to domains known to be associated with the APT41 threat actor's TOUGHPROGRESS campaign.
    These domains were used to host malware payloads or facilitate command-and-control via free hosting platforms like Cloudflare Workers, TryCloudflare, and InfinityFree.
    DNS queries to these domains in enterprise environments may indicate compromise by TOUGHPROGRESS or related malware components.
references:
    - https://cloud.google.com/blog/topics/threat-intelligence/apt41-innovative-tactics
author: Ahmed Nosir (@egycondor)
date: 2025-06-02
logsource:
    product: windows
    category: dns_query
detection:
    selection:
        QueryName|contains:
            - 'msapp.workers.dev'
            - 'trycloudflare.com'
            - 'infinityfreeapp.com'
            - 'my5353.com'
            - 'reurl.cc'
            - 'lihi.cc'
            - 'tinyurl.com'
    condition: selection
falsepositives:
    - Legitimate use of these services is possible but rare in enterprise environments
level: medium
