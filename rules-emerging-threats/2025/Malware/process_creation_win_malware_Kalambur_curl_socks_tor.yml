title: Kalambur Backdoor Curl TOR SOCKS Proxy Detection
id: E99375EB-3EE0-407A-9F90-79569CC6A01C
date: 2025-02-11
status: test
author: Arda Buyukkaya (EclecticIQ)
description: >
  Detects executions of curl.exe where the command-line arguments include a SOCKS proxy pattern 
  ("socks5h://", "socks4a://", "socks5://") or reference to an .onion domain.
  This helps identify potential TOR SOCKS Proxy attempts using curl.

references:
  - https://blog.eclecticiq.com/sandworm-apt-targets-ukrainian-users-with-trojanized-microsoft-kms-activation-tools-in-cyber-espionage-campaigns
tags:
  - attack.t1090  
  - attack.t1573  
  - attack.t1071.001  
  - attack.t1059.001  
  - attack.s0183  

logsource:
  category: process_creation
  product: windows

detection:
  selection:
    Image|endswith: '\\curl.exe'
    CommandLine|contains:
      - 'socks5h://'
      - 'socks5://'
      - 'socks4a://'
      - '.onion'
  condition: selection

falsepositives:
  - Legitimate use of curl with SOCKS proxies or TOR

level: medium
