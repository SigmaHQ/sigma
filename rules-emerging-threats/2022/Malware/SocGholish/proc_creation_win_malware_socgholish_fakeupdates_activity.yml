title: FakeUpdates/SocGholish Activity
id: 97805087-93ab-4203-b5cb-287cda6aecaa
status: experimental
description: Detects initial execution of FakeUpdates/SocGholish malware via wscript that later executes commands via cmd or powershell.
references:
    - https://twitter.com/th3_protoCOL/status/1536788652889497600
    - https://twitter.com/1ZRR4H/status/1537501582727778304
author: '@kostastsale'
date: 2022-06-16
modified: 2024-08-23
tags:
    - attack.execution
    - attack.t1059.001
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentImage|endswith: '\wscript.exe'
        ParentCommandLine|contains|all:
            - '\AppData\Local\Temp'
            - '.zip'
            - 'update'
            - '.js'
        ParentCommandLine|contains:
            - 'Chrome'
            - 'Edge'
            - 'Firefox'
            - 'Opera'
            - 'Brave' # Not seen in campaigns
            - 'Vivaldi' # Not seen in campaigns
        Image|endswith:
            - '\cmd.exe'
            - '\powershell.exe'
            - '\pwsh.exe'
    condition: selection
falsepositives:
    - Unlikely
level: high
