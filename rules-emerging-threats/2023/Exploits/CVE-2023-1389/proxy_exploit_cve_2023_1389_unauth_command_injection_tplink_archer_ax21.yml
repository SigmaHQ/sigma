title: CVE-2023-1389 Potential Exploitation Attempt - Unauthenticated Command Injection In TP-Link Archer AX21
id: 6c7defa9-69f8-4c34-b815-41fce3931754
status: experimental
description: |
    Detects potential exploitation attempt of CVE-2023-1389 an Unauthenticated Command Injection in TP-Link Archer AX21.
references:
    - https://www.tenable.com/security/research/tra-2023-11
    - https://github.com/Voyag3r-Security/CVE-2023-1389/blob/4ecada7335b17bf543c0e33b2c9fb6b6215c09ae/archer-rev-shell.py
    - https://www.zerodayinitiative.com/blog/2023/4/21/tp-link-wan-side-vulnerability-cve-2023-1389-added-to-the-mirai-botnet-arsenal
author: Nasreddine Bencherchali (Nextron Systems), Rohit Jain
date: 2024-06-25
tags:
    - detection.emerging-threats
    - attack.initial-access
    - attack.t1190
    - cve.2023-1389
logsource:
    category: proxy
detection:
    selection_uri:
        cs-method:
            - 'GET'
            - 'POST'
        cs-uri|contains|all:
            - '/cgi-bin/luci/;stok=/locale'
            - 'form=country'
    selection_keyword:
        - 'operation=write'
        - 'country=$('
    condition: all of selection_*
falsepositives:
    - Vulnerability Scanners
level: medium
