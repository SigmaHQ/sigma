title: Potential MOVEit Transfer Exploitation
id: c3b2a774-3152-4989-83c1-7afc48fd1599
status: experimental
description: |
    Detects the creation of files with unexpected extensions in the web root folder of the MOVEit Transfer service.
    Reports mentioned uncommon file types in the "wwwroot" folder as a sign of potential compromise. Attackers used that folder as a staging directory for the exfiltration.
references:
    - https://www.bleepingcomputer.com/news/security/new-moveit-transfer-zero-day-mass-exploited-in-data-theft-attacks/
    - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
    - https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/
    - https://www.reddit.com/r/sysadmin/comments/13wxuej/comment/jmhdg55/
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2023/06/01
tags:
    - attack.initial_access
    - attack.t1190
logsource:
    category: file_event
    product: windows
detection:
    selection_generic:
        TargetFilename|contains:
            - '\MOVEit Transfer\wwwroot\'
            - '\MOVEitTransfer\wwwroot\'
        TargetFilename|endswith:
            - '.7z'
            - '.bat'
            - '.dll'
            - '.exe'
            - '.ps1'
            - '.rar'
            - '.vbe'
            - '.vbs'
            - '.zip'
    selection_known_ioc:
        TargetFilename|endswith:
            - '\MOVEit Transfer\wwwroot\human2.aspx'
            - '\MOVEitTransfer\wwwroot\human2.aspx'
    selection_compiled_asp:
        CreationUtcTime|startswith:
            - '2023-05-26 '
            - '2023-05-27 '
            - '2023-05-28 '
            - '2023-05-29 '
            - '2023-05-30 '
            - '2023-05-31 '
            - '2023-06-01 '
            - '2023-06-02 '
            - '2023-06-03 '
        TargetFilename|contains|all:
            - '\Windows\Microsoft.net\Framework64\v'
            - '\Temporary ASP.NET Files\'
            - 'App_Web_'
        TargetFilename|endswith: '.dll'
    condition: 1 of selection_*
falsepositives:
    - Unlikely
level: high
