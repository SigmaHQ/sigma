title: CVE-2023-38331 Exploitation Attempt - Suspicious WinRAR Child Process
id: ec3a3c2f-9bb0-4a9b-8f4b-5ec386544343
related:
    - id: e4556676-fc5c-4e95-8c39-5ef27791541f
      type: similar
status: test
description: Detects exploitation attempt of CVE-2023-38331 (WinRAR before v6.23), where an attacker can leverage WinRAR to execute arbitrary commands and binaries.
references:
    - https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/
    - https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md
author: Nasreddine Bencherchali (Nextron Systems), Andreas Braathen (mnemonic.io)
date: 2023-08-30
modified: 2024-01-22
tags:
    - detection.emerging-threats
    - attack.execution
    - attack.t1203
    - cve.2023-38331
logsource:
    category: process_creation
    product: windows
detection:
    selection_parent:
        ParentImage|endswith: '\WinRAR.exe'
    selection_folder:
        CommandLine|contains: '\AppData\Local\Temp\Rar$'
    selection_double_ext:
        CommandLine|re: '\.[a-zA-Z0-9]{1,4} \.'
    selection_binaries:
        # Note: add additional binaries that the attacker might use
        - Image|endswith:
              - '\cmd.exe'
              - '\cscript.exe'
              - '\powershell.exe'
              - '\pwsh.exe'
              - '\wscript.exe'
        - OriginalFileName:
              - 'Cmd.Exe'
              - 'cscript.exe'
              - 'PowerShell.EXE'
              - 'pwsh.dll'
              - 'wscript.exe'
    condition: all of selection_*
falsepositives:
    - Unlikely
level: high
