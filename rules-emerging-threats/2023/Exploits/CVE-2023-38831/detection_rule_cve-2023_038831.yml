title: Advanced Detection of WinRAR Vulnerability CVE-2023-38831 Exploitation
id: 2024-01-92-001
status: experimental
description: Detects sophisticated exploitation attempts of WinRAR vulnerability (CVE-2023-38831) using advanced criteria.
author: Aung Myat Thu aka w01f
references:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38831
logsource:
    product: windows
    service: sysmon
detection:
    selection1:
        EventID: 1
        Image: 'C:\Program Files\WinRAR\WinRAR.exe'
        CommandLine:
            - '*rar*'
            - '*exe*'
            - '*cmd*'
            - '*powershell*'
            - '*script*'
            - '*base64*'
    selection2:
        EventID: 3
        DestinationPort:
            - 80
            - 443
        Image: 'C:\Program Files\WinRAR\WinRAR.exe'
    condition: selection1 and selection2
falsepositives:
    - Legitimate use of WinRAR with command line arguments
    - Automated scripts for backup or maintenance using WinRAR
level: high
tags:
    - attack.execution
    - cve.CVE-2023-38831
    - lateral.movement
    - exfiltration
