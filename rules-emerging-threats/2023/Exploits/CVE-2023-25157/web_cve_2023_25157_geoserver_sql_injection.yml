title: Potential CVE-2023-25157 Exploitation Attempt
id: c0341543-5ed0-4475-aabc-7eea8c52aa66
status: test
description: Detects a potential exploitation attempt of CVE-2023-25157 a SQL injection in GeoServer
references:
    - https://github.com/win3zz/CVE-2023-25157
    - https://twitter.com/parzel2/status/1665726454489915395
    - https://github.com/advisories/GHSA-7g5f-wrx8-5ccf
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/06/14
tags:
    - attack.initial_access
    - cve.2023.25157
    - detection.emerging_threats
logsource:
    category: webserver
detection:
    selection_url:
        cs-method: 'GET'
        cs-uri-query|contains|all:
            - '/geoserver/ows'
            - 'CQL_FILTER='
        cs-uri-query|contains:
            # Abusable Filters/Function as reported in the Advisory
            - 'PropertyIsLike'
            - 'strEndsWith'
            - 'strStartsWith'
            - 'FeatureId'
            - 'jsonArrayContains'
            - 'DWithin'
    selection_payload:
        cs-uri-query|contains:
            - '+--'
            - '+AS+'
            - '+OR+'
            - 'FROM'
            - 'ORDER+BY'
            - 'SELECT'
            - 'sleep%28'
            - 'substring%28'
            - 'UNION'
            - 'WHERE'
    condition: all of selection_*
falsepositives:
    - Vulnerability scanners
level: high
