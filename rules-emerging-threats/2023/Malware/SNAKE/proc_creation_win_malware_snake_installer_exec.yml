title: Potential SNAKE Malware Installation Binary Indicator
id: d91ff53f-fd0c-419d-a6b8-ae038d5c3733
status: test
description: Detects a specific binary name seen used by SNAKE malware during its installation as described by CISA in their report
references:
    - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/05/04
tags:
    - attack.execution
    - detection.emerging_threats
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\jpsetup.exe'
            - '\jpinst.exe'
    filter_main_cli_name:
        CommandLine:
            - 'jpinst.exe'
            - 'jpinst'
            - 'jpsetup.exe'
            - 'jpsetup'
    filter_main_cli_empty:
        CommandLine: ''
    filter_main_cli_null:
        CommandLine: null
    condition: selection and not 1 of filter_main_*
falsepositives:
    - Unlikely
level: high
