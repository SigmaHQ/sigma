title: SNAKE Malware Service Persistence
id: b2e60816-96b2-45bd-ba91-b63578c03ef6
status: test
description: Detects the creation of a service named "WerFaultSvc" which seems to be used by the SNAKE malware as a persistence mechanism as described by CISA in their report
references:
    - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023-05-10
tags:
    - attack.persistence
    - detection.emerging-threats
logsource:
    product: windows
    service: system
detection:
    selection:
        Provider_Name: 'Service Control Manager'
        EventID: 7045
        ServiceName|contains: 'WerFaultSvc' # Note: The report contains a "," in the name ("WerFaultSvc,"). Since we can't confirm if its a typo or not we don't use it
        ImagePath|startswith: 'C:\Windows\WinSxS\'
        ImagePath|endswith: '\WerFault.exe'
    condition: selection
falsepositives:
    - Unknown
level: critical
