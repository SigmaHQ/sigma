title: SonicWall SSL/VPN Jarrewrite Exploitation
id: 6f55f047-112b-4101-ad32-43913f52db46
status: test
description: Detects exploitation attempts of the SonicWall Jarrewrite Exploit
references:
    - https://web.archive.org/web/20210126045316/https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/
    - https://github.com/darrenmartyn/VisualDoor
author: Florian Roth (Nextron Systems)
date: 2021-01-25
modified: 2023-04-27
tags:
    - attack.t1190
    - attack.initial-access
    - detection.emerging-threats
logsource:
    category: webserver
detection:
    selection:
        cs-uri-query|contains: '/cgi-bin/jarrewrite.sh'
        cs-user-agent|contains:
            - ':;'
            - '() {'
            - '/bin/bash -c'
    condition: selection
fields:
    - c-ip
    - c-dns
falsepositives:
    - Unknown
level: high
