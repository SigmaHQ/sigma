title: Potential Hex Staging Attack
id: 647c1b89-d717-4a0a-816b-2f129500f76f
status: experimental
description: This Rule Hex Staging Whereby a Threat Actor Delivers Malicious Executable Payload in Hexadecimal Chunks By Writing The Data To a Temporary File Using Cmd.exe.The /p Parameter Takes The Hexadecimal Payload as Input.
The Encoded Payload Is Later Decoded Using Inbuilt Tools e.g certutil For Further Execution.
references:
    - https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities
author: Joseph Kamau
date: 2025-10-02
tags:
    - attack.defense-evasion
    - attack.t1027.013
    - detection.threat-hunting
logsource:
    product: windows
    category: process_creation
detection:
    selection:
        Image|endswith: \cmd.exe
        CommandLine|contains|all:
            - set
            - /p=
            - .tmp
    condition: selection
falsepositives:
    - Legitimate Use Of The Listed Parameters To Encode Data.
level: medium
