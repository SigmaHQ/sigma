title: Potential Hex Staging Attack
id: 647c1b89-d717-4a0a-816b-2f129500f76f
status: experimental
description: |
    Detects potential hex staging attack. Threat Actor often delivers malicious executable payload in hexadecimal chunks by writing the data to a temporary file using cmd.exe.
    The /p parameter takes the hexadecimal payload as input. The encoded payload is later decoded using inbuilt tools e.g certutil for further execution.
    During investigation, examine the temporary files created, analyze the hex content for malicious patterns, check for subsequent process executions (particularly certutil), and investigate the source of the command execution and the parent process.
references:
    - https://unit42.paloaltonetworks.com/espionage-campaign-targets-south-asian-entities
author: Joseph Kamau
date: 2025-10-02
tags:
    - attack.defense-evasion
    - attack.t1027.013
    - detection.threat-hunting
logsource:
    product: windows
    category: process_creation
detection:
    selection:
        Image|endswith: '\cmd.exe'
        CommandLine|contains|all:
            - 'set'
            - '/p='
            - '>>'
           
    condition: selection
falsepositives:
    - The "/p" parameter is used legitimately in various batch installer. Apply additional tuning when necessary
level: medium
